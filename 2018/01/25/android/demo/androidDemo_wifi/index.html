<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="kylinhuang">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://www.kylinhuang.cn">
    <!--SEO-->

    <meta name="keywords" content>


    <meta name="description" content="android wifi 自动连接连接方式
无密码连接
mWifiManager.disconnect();
其他网络 enableNetwork
创建网络 mWifiManager 中添加网络...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>android demo wifi | kylinhuang</title>


    <link rel="alternate" href="/atom.xml" title="kylinhuang" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>






    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header" style="background-image:url(http://snippet.shenliyang.com/img/banner.jpg)">
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="kylinhuang">
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                 <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://www.kylinhuang.cn">kylinhuang</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/前端/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/后端/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/工具/"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="android demo wifi">
            
	            android demo wifi
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/android/">android</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/01/25</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>447</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <h1 id="android-wifi-自动连接"><a href="#android-wifi-自动连接" class="headerlink" title="android wifi 自动连接"></a>android wifi 自动连接</h1><p>连接方式</p>
<h2 id="无密码连接"><a href="#无密码连接" class="headerlink" title="无密码连接"></a>无密码连接</h2><ol>
<li>mWifiManager.disconnect();</li>
<li>其他网络 enableNetwork</li>
<li>创建网络 mWifiManager 中添加网络</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public boolean connectSpecificAP(ScanResult scan) &#123;</span><br><span class="line">        List&lt;WifiConfiguration&gt; list = mWifiManager.getConfiguredNetworks();</span><br><span class="line">        boolean networkInSupplicant = false;</span><br><span class="line">        boolean connectResult = false;</span><br><span class="line">        // 重新连接指定AP</span><br><span class="line">        mWifiManager.disconnect();</span><br><span class="line">        for (WifiConfiguration w : list) &#123;</span><br><span class="line">            // 将指定AP 名字转化</span><br><span class="line">            // String str = convertToQuotedString(info.ssid);</span><br><span class="line">            if (w.BSSID != null &amp;&amp; w.BSSID.equals(scan.BSSID)) &#123;</span><br><span class="line">                connectResult = mWifiManager.enableNetwork(w.networkId, true);</span><br><span class="line">                // mWifiManager.saveConfiguration();</span><br><span class="line">                networkInSupplicant = true;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (!networkInSupplicant) &#123;</span><br><span class="line">            WifiConfiguration config = CreateWifiInfo(scan, &quot;&quot;);</span><br><span class="line">            connectResult = addNetwork(config);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return connectResult;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>创建网络</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">// 然后是一个实际应用方法，只验证过没有密码的情况：</span><br><span class="line">    public WifiConfiguration CreateWifiInfo(ScanResult scan, String Password) &#123;</span><br><span class="line">        WifiConfiguration config = new WifiConfiguration();</span><br><span class="line">        config.hiddenSSID = false;</span><br><span class="line">        config.status = WifiConfiguration.Status.ENABLED;</span><br><span class="line"></span><br><span class="line">        if (scan.capabilities.contains(&quot;WEP&quot;)) &#123;</span><br><span class="line">            config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);</span><br><span class="line">            config.allowedAuthAlgorithms</span><br><span class="line">                    .set(WifiConfiguration.AuthAlgorithm.OPEN);</span><br><span class="line">            config.allowedGroupCiphers</span><br><span class="line">                    .set(WifiConfiguration.GroupCipher.WEP104);</span><br><span class="line"></span><br><span class="line">            config.SSID = &quot;\&quot;&quot; + scan.SSID + &quot;\&quot;&quot;;</span><br><span class="line"></span><br><span class="line">            config.wepTxKeyIndex = 0;</span><br><span class="line">            config.wepKeys[0] = Password;</span><br><span class="line">            // config.preSharedKey = &quot;\&quot;&quot; + SHARED_KEY + &quot;\&quot;&quot;;</span><br><span class="line">        &#125; else if (scan.capabilities.contains(&quot;PSK&quot;)) &#123;</span><br><span class="line">            //</span><br><span class="line">            config.SSID = &quot;\&quot;&quot; + scan.SSID + &quot;\&quot;&quot;;</span><br><span class="line">            config.preSharedKey = &quot;\&quot;&quot; + Password + &quot;\&quot;&quot;;</span><br><span class="line">        &#125; else if (scan.capabilities.contains(&quot;EAP&quot;)) &#123;</span><br><span class="line">            config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_EAP);</span><br><span class="line">            config.allowedAuthAlgorithms</span><br><span class="line">                    .set(WifiConfiguration.AuthAlgorithm.OPEN);</span><br><span class="line">            config.allowedPairwiseCiphers</span><br><span class="line">                    .set(WifiConfiguration.PairwiseCipher.TKIP);</span><br><span class="line">            config.allowedProtocols.set(WifiConfiguration.Protocol.WPA);</span><br><span class="line">            config.SSID = &quot;\&quot;&quot; + scan.SSID + &quot;\&quot;&quot;;</span><br><span class="line">            config.preSharedKey = &quot;\&quot;&quot; + Password + &quot;\&quot;&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);</span><br><span class="line"></span><br><span class="line">            config.SSID = &quot;\&quot;&quot; + scan.SSID + &quot;\&quot;&quot;;</span><br><span class="line">            // config.BSSID = info.mac;</span><br><span class="line">            config.preSharedKey = null;</span><br><span class="line">            //</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return config;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>添加到网络</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 添加到网络</span><br><span class="line">     *</span><br><span class="line">     * @author Xiho</span><br><span class="line">     * @param wcg</span><br><span class="line">     */</span><br><span class="line">    public boolean addNetwork(WifiConfiguration wcg) &#123;</span><br><span class="line">        if (wcg == null) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // receiverDhcp = new ReceiverDhcp(ctx, mWifiManager, this,</span><br><span class="line">        // wlanHandler);</span><br><span class="line">        // ctx.registerReceiver(receiverDhcp, new</span><br><span class="line">        // IntentFilter(WifiManager.NETWORK_STATE_CHANGED_ACTION));</span><br><span class="line">        int wcgID = mWifiManager.addNetwork(wcg);</span><br><span class="line">        boolean b = mWifiManager.enableNetwork(wcgID, true);</span><br><span class="line">        mWifiManager.saveConfiguration();</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        return b;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="有密码连接"><a href="#有密码连接" class="headerlink" title="有密码连接"></a>有密码连接</h2><ol>
<li>在wifi列表中获取 加密方式scanResult.capabilities</li>
<li>创建 WifiConfiguration</li>
<li>添加到 WifiManager</li>
<li>WifiManager断开连接<br><code>WifiManager.disconnect()</code></li>
<li>WifiManager 其他的连接断开<code>WifiManager.enableNetwork(netID, true)</code></li>
<li>WifiManager 重新连接<br><code>WifiManager.reconnect()</code></li>
</ol>
<p>code</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 给外部提供一个借口，连接无线网络</span><br><span class="line">     *</span><br><span class="line">     * @param SSID</span><br><span class="line">     * @param Password</span><br><span class="line">     * @param Type</span><br><span class="line">     * @return &lt;br&gt;</span><br><span class="line">     * @return true:连接成功；false:连接失败&lt;br&gt;</span><br><span class="line">     *</span><br><span class="line">     */</span><br><span class="line">    public boolean connect(String SSID, String Password, WifiConnectUtils.WifiCipherType Type) &#123;</span><br><span class="line">        if (!this.openWifi()) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // 状态变成WIFI_STATE_ENABLED的时候才能执行下面的语句</span><br><span class="line">        while (mWifiManager.getWifiState() == WifiManager.WIFI_STATE_ENABLING) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                // 为了避免程序一直while循环，让它睡个100毫秒在检测……</span><br><span class="line">                Thread.currentThread();</span><br><span class="line">                Thread.sleep(100);</span><br><span class="line">            &#125; catch (InterruptedException ie) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (SSID == null || Password == null || SSID.equals(&quot;&quot;)) &#123;</span><br><span class="line">            Log.e(this.getClass().getName(),</span><br><span class="line">                    &quot;addNetwork() ## nullpointer error!&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        WifiConfiguration wifiConfig = createWifiInfo(SSID, Password, Type);</span><br><span class="line">        // wifi的配置信息</span><br><span class="line">        if (wifiConfig == null) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // 查看以前是否也配置过这个网络</span><br><span class="line">        WifiConfiguration tempConfig = this.isExsits(SSID);</span><br><span class="line">        if (tempConfig != null) &#123;</span><br><span class="line"></span><br><span class="line">            mWifiManager.removeNetwork(tempConfig.networkId);</span><br><span class="line">        &#125;</span><br><span class="line">        // 添加一个新的网络描述为一组配置的网络。</span><br><span class="line">        int netID = mWifiManager.addNetwork(wifiConfig);</span><br><span class="line">        Log.d(&quot;WifiListActivity&quot;, &quot;wifi的netID为：&quot; + netID);</span><br><span class="line">        // 断开连接</span><br><span class="line">        mWifiManager.disconnect();</span><br><span class="line">        // 重新连接</span><br><span class="line">        Log.d(&quot;WifiListActivity&quot;, &quot;Wifi的重新连接netID为：&quot; + netID);</span><br><span class="line">        // 设置为true,使其他的连接断开</span><br><span class="line">        boolean mConnectConfig = mWifiManager.enableNetwork(netID, true);</span><br><span class="line">        mWifiManager.reconnect();</span><br><span class="line">        return mConnectConfig;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>网上大多数demo 都是这样子的</p>
<h2 id="兼容性问题"><a href="#兼容性问题" class="headerlink" title="兼容性问题"></a>兼容性问题</h2><table>
<thead>
<tr>
<th>系统</th>
<th>手机型号</th>
<th>无密码连接</th>
<th>密码连接</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.4.2</td>
<td>华为p6-06</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>4.4.4</td>
<td>酷派</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>5.1.0</td>
<td>moto XT</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>7.1.1 android 原生系统</td>
<td>Moto G Play</td>
<td>NO (wifi 会断开 后重新连接 之前的wifi 并非指定的)</td>
<td>NO (wifi 会断开 后重新连接 之前的wifi 并非指定的)</td>
</tr>
<tr>
<td>8.0.0</td>
<td>华为mate 9</td>
<td>NO (wifi 会断开 后重新连接 之前的wifi 并非指定的)</td>
<td>NO (wifi 会断开 后重新连接 之前的wifi 并非指定的)</td>
</tr>
</tbody>
</table>
<h2 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h2><h2 id="android-4-4-4"><a href="#android-4-4-4" class="headerlink" title="android 4.4.4"></a>android 4.4.4</h2><p>android 源码<br><a href="http://androidxref.com/4.4.4_r1/xref/packages/apps/Settings/src/com/android/settings/wifi/WifiSettings.java" target="_blank" rel="noopener">http://androidxref.com/4.4.4_r1/xref/packages/apps/Settings/src/com/android/settings/wifi/WifiSettings.java</a></p>
<p>575行  onContextItemSelected(MenuItem item)<br> 该方法中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">574  @Override</span><br><span class="line">575    public boolean onContextItemSelected(MenuItem item) &#123;</span><br><span class="line">576        if (mSelectedAccessPoint == null) &#123;</span><br><span class="line">577            return super.onContextItemSelected(item);</span><br><span class="line">578        &#125;</span><br><span class="line">579        switch (item.getItemId()) &#123;</span><br><span class="line">580            case MENU_ID_CONNECT: &#123;</span><br><span class="line">581                if (mSelectedAccessPoint.networkId != INVALID_NETWORK_ID) &#123;</span><br><span class="line">582                    mWifiManager.connect(mSelectedAccessPoint.networkId,</span><br><span class="line">583                            mConnectListener);</span><br><span class="line">584                &#125; else if (mSelectedAccessPoint.security == AccessPoint.SECURITY_NONE) &#123;</span><br><span class="line">585                    /** Bypass dialog for unsecured networks */</span><br><span class="line">586                    mSelectedAccessPoint.generateOpenNetworkConfig();</span><br><span class="line">587                    mWifiManager.connect(mSelectedAccessPoint.getConfig(),</span><br><span class="line">588                            mConnectListener);</span><br><span class="line">589                &#125; else &#123;</span><br><span class="line">590                    showDialog(mSelectedAccessPoint, true);</span><br><span class="line">591                &#125;</span><br><span class="line">592                return true;</span><br><span class="line">593            &#125;</span><br><span class="line">594            case MENU_ID_FORGET: &#123;</span><br><span class="line">595                mWifiManager.forget(mSelectedAccessPoint.networkId, mForgetListener);</span><br><span class="line">596                return true;</span><br><span class="line">597            &#125;</span><br><span class="line">598            case MENU_ID_MODIFY: &#123;</span><br><span class="line">599                showDialog(mSelectedAccessPoint, true);</span><br><span class="line">600                return true;</span><br><span class="line">601            &#125;</span><br><span class="line">602        &#125;</span><br><span class="line">603        return super.onContextItemSelected(item);</span><br><span class="line">604    &#125;</span><br></pre></td></tr></table></figure>
<p>580 点击链接<br>无密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">586                    mSelectedAccessPoint.generateOpenNetworkConfig();</span><br><span class="line">587                    mWifiManager.connect(mSelectedAccessPoint.getConfig(),</span><br><span class="line">588                            mConnectListener);</span><br></pre></td></tr></table></figure>
<p>具体分析<br>mSelectedAccessPoint.generateOpenNetworkConfig();</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">390    protected void generateOpenNetworkConfig() &#123;</span><br><span class="line">391        if (security != SECURITY_NONE)</span><br><span class="line">392            throw new IllegalStateException();</span><br><span class="line">393        if (mConfig != null)</span><br><span class="line">394            return;</span><br><span class="line">395        mConfig = new WifiConfiguration();</span><br><span class="line">396        mConfig.SSID = AccessPoint.convertToQuotedString(ssid);</span><br><span class="line">397        mConfig.allowedKeyManagement.set(KeyMgmt.NONE);</span><br><span class="line">398    &#125;</span><br></pre></td></tr></table></figure>
<p>mSelectedAccessPoint.getConfig()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">312    WifiConfiguration getConfig() &#123;</span><br><span class="line">313        return mConfig;</span><br><span class="line">314    &#125;</span><br></pre></td></tr></table></figure>
<p>mSelectedAccessPoint  的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">553    @Override</span><br><span class="line">554    public void onCreateContextMenu(ContextMenu menu, View view, ContextMenuInfo info) &#123;</span><br><span class="line">555        if (info instanceof AdapterContextMenuInfo) &#123;</span><br><span class="line">556            Preference preference = (Preference) getListView().getItemAtPosition(</span><br><span class="line">557                    ((AdapterContextMenuInfo) info).position);</span><br><span class="line">558</span><br><span class="line">559            if (preference instanceof AccessPoint) &#123;</span><br><span class="line">560                mSelectedAccessPoint = (AccessPoint) preference;</span><br><span class="line">561                menu.setHeaderTitle(mSelectedAccessPoint.ssid);</span><br><span class="line">562                if (mSelectedAccessPoint.getLevel() != -1</span><br><span class="line">563                        &amp;&amp; mSelectedAccessPoint.getState() == null) &#123;</span><br><span class="line">564                    menu.add(Menu.NONE, MENU_ID_CONNECT, 0, R.string.wifi_menu_connect);</span><br><span class="line">565                &#125;</span><br><span class="line">566                if (mSelectedAccessPoint.networkId != INVALID_NETWORK_ID) &#123;</span><br><span class="line">567                    menu.add(Menu.NONE, MENU_ID_FORGET, 0, R.string.wifi_menu_forget);</span><br><span class="line">568                    menu.add(Menu.NONE, MENU_ID_MODIFY, 0, R.string.wifi_menu_modify);</span><br><span class="line">569                &#125;</span><br><span class="line">570            &#125;</span><br><span class="line">571        &#125;</span><br><span class="line">572    &#125;</span><br></pre></td></tr></table></figure></p>
<p>mWifiManager.connect(mSelectedAccessPoint.getConfig(),mConnectListener);<br>分析WifiManager</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1586    public void connect(WifiConfiguration config, ActionListener listener) &#123;</span><br><span class="line">1587        if (config == null) throw new IllegalArgumentException(&quot;config cannot be null&quot;);</span><br><span class="line">1588        validateChannel();</span><br><span class="line">1589        // Use INVALID_NETWORK_ID for arg1 when passing a config object</span><br><span class="line">1590        // arg1 is used to pass network id when the network already exists</span><br><span class="line">1591        sAsyncChannel.sendMessage(CONNECT_NETWORK, WifiConfiguration.INVALID_NETWORK_ID,</span><br><span class="line">1592                putListener(listener), config);</span><br><span class="line">1593    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-1-1"><a href="#7-1-1" class="headerlink" title="7.1.1"></a>7.1.1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">477    @Override</span><br><span class="line">478    public boolean onContextItemSelected(MenuItem item) &#123;</span><br><span class="line">479        if (mSelectedAccessPoint == null) &#123;</span><br><span class="line">480            return super.onContextItemSelected(item);</span><br><span class="line">481        &#125;</span><br><span class="line">482        switch (item.getItemId()) &#123;</span><br><span class="line">483            case MENU_ID_CONNECT: &#123;</span><br><span class="line">484                if (mSelectedAccessPoint.isSaved()) &#123;</span><br><span class="line">485                    connect(mSelectedAccessPoint.getConfig());</span><br><span class="line">486                &#125; else if (mSelectedAccessPoint.getSecurity() == AccessPoint.SECURITY_NONE) &#123;</span><br><span class="line">487                    /** Bypass dialog for unsecured networks */</span><br><span class="line">488                    mSelectedAccessPoint.generateOpenNetworkConfig();</span><br><span class="line">489                    connect(mSelectedAccessPoint.getConfig());</span><br><span class="line">490                &#125; else &#123;</span><br><span class="line">491                    showDialog(mSelectedAccessPoint, WifiConfigUiBase.MODE_CONNECT);</span><br><span class="line">492                &#125;</span><br><span class="line">493                return true;</span><br><span class="line">494            &#125;</span><br><span class="line">495            case MENU_ID_FORGET: &#123;</span><br><span class="line">496                forget();</span><br><span class="line">497                return true;</span><br><span class="line">498            &#125;</span><br><span class="line">499            case MENU_ID_MODIFY: &#123;</span><br><span class="line">500                showDialog(mSelectedAccessPoint, WifiConfigUiBase.MODE_MODIFY);</span><br><span class="line">501                return true;</span><br><span class="line">502            &#125;</span><br><span class="line">503            case MENU_ID_WRITE_NFC:</span><br><span class="line">504                showDialog(WRITE_NFC_DIALOG_ID);</span><br><span class="line">505                return true;</span><br><span class="line">506</span><br><span class="line">507        &#125;</span><br><span class="line">508        return super.onContextItemSelected(item);</span><br><span class="line">509    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">853    protected void connect(final WifiConfiguration config) &#123;</span><br><span class="line">854        MetricsLogger.action(getActivity(), MetricsEvent.ACTION_WIFI_CONNECT);</span><br><span class="line">855        mWifiManager.connect(config, mConnectListener);</span><br><span class="line">856    &#125;</span><br></pre></td></tr></table></figure>
<p>相对 4.4.4  引入<br>MetricsLogger.action(getActivity(), MetricsEvent.ACTION_WIFI_CONNECT);</p>
<p><a href="http://androidxref.com/7.1.1_r6/xref/frameworks/base/core/java/com/android/internal/logging/MetricsLogger.java" target="_blank" rel="noopener">http://androidxref.com/7.1.1_r6/xref/frameworks/base/core/java/com/android/internal/logging/MetricsLogger.java</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">62    public static void action(Context context, int category) &#123;</span><br><span class="line">63        action(context, category, &quot;&quot;);</span><br><span class="line">64    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">74    public static void action(Context context, int category, String pkg) &#123;</span><br><span class="line">75        if (Build.IS_DEBUGGABLE &amp;&amp; category == VIEW_UNKNOWN) &#123;</span><br><span class="line">76            throw new IllegalArgumentException(&quot;Must define metric category&quot;);</span><br><span class="line">77        &#125;</span><br><span class="line">78        EventLogTags.writeSysuiAction(category, pkg);</span><br><span class="line">79    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventLogTags.writeSysuiAction(category, pkg);</span><br></pre></td></tr></table></figure>
<h2 id="8-0-0-8-0-0-r4"><a href="#8-0-0-8-0-0-r4" class="headerlink" title="8.0.0  8.0.0_r4"></a>8.0.0  8.0.0_r4</h2><p><a href="http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/wifi/WifiSettings.java" target="_blank" rel="noopener">http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/wifi/WifiSettings.java</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">509    @Override</span><br><span class="line">510    public boolean onContextItemSelected(MenuItem item) &#123;</span><br><span class="line">511        if (mSelectedAccessPoint == null) &#123;</span><br><span class="line">512            return super.onContextItemSelected(item);</span><br><span class="line">513        &#125;</span><br><span class="line">514        switch (item.getItemId()) &#123;</span><br><span class="line">515            case MENU_ID_CONNECT: &#123;</span><br><span class="line">516                boolean isSavedNetwork = mSelectedAccessPoint.isSaved();</span><br><span class="line">517                if (isSavedNetwork) &#123;</span><br><span class="line">518                    connect(mSelectedAccessPoint.getConfig(), isSavedNetwork);</span><br><span class="line">519                &#125; else if (mSelectedAccessPoint.getSecurity() == AccessPoint.SECURITY_NONE) &#123;</span><br><span class="line">520                    /** Bypass dialog for unsecured networks */</span><br><span class="line">521                    mSelectedAccessPoint.generateOpenNetworkConfig();</span><br><span class="line">522                    connect(mSelectedAccessPoint.getConfig(), isSavedNetwork);</span><br><span class="line">523                &#125; else &#123;</span><br><span class="line">524                    showDialog(mSelectedAccessPoint, WifiConfigUiBase.MODE_CONNECT);</span><br><span class="line">525                &#125;</span><br><span class="line">526                return true;</span><br><span class="line">527            &#125;</span><br><span class="line">528            case MENU_ID_FORGET: &#123;</span><br><span class="line">529                forget();</span><br><span class="line">530                return true;</span><br><span class="line">531            &#125;</span><br><span class="line">532            case MENU_ID_MODIFY: &#123;</span><br><span class="line">533                showDialog(mSelectedAccessPoint, WifiConfigUiBase.MODE_MODIFY);</span><br><span class="line">534                return true;</span><br><span class="line">535            &#125;</span><br><span class="line">536            case MENU_ID_WRITE_NFC:</span><br><span class="line">537                showDialog(WRITE_NFC_DIALOG_ID);</span><br><span class="line">538                return true;</span><br><span class="line">539</span><br><span class="line">540        &#125;</span><br><span class="line">541        return super.onContextItemSelected(item);</span><br><span class="line">542    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1003    protected void connect(final WifiConfiguration config, boolean isSavedNetwork) &#123;</span><br><span class="line">1004        // Log subtype if configuration is a saved network.</span><br><span class="line">1005        mMetricsFeatureProvider.action(getActivity(), MetricsEvent.ACTION_WIFI_CONNECT,</span><br><span class="line">1006                isSavedNetwork);</span><br><span class="line">1007        mWifiManager.connect(config, mConnectListener);</span><br><span class="line">1008    &#125;</span><br></pre></td></tr></table></figure>
<p>android 8.0  这里 又做了修改</p>
<p><a href="http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/core/instrumentation/MetricsFeatureProvider.java" target="_blank" rel="noopener">http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/core/instrumentation/MetricsFeatureProvider.java</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">63    public void action(Context context, int category, Pair&lt;Integer, Object&gt;... taggedData) &#123;</span><br><span class="line">64        for (LogWriter writer : mLoggerWriters) &#123;</span><br><span class="line">65            writer.action(context, category, taggedData);</span><br><span class="line">66        &#125;</span><br><span class="line">67    &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">33    private List&lt;LogWriter&gt; mLoggerWriters;</span><br><span class="line">34</span><br><span class="line">35    public MetricsFeatureProvider() &#123;</span><br><span class="line">36        mLoggerWriters = new ArrayList&lt;&gt;();</span><br><span class="line">37        installLogWriters();</span><br><span class="line">38    &#125;</span><br><span class="line">39</span><br><span class="line">40    protected void installLogWriters() &#123;</span><br><span class="line">41        mLoggerWriters.add(new EventLogWriter());</span><br><span class="line">42        mLoggerWriters.add(new SettingSuggestionsLogWriter());</span><br><span class="line">43    &#125;</span><br></pre></td></tr></table></figure>
<p>主要是 EventLogWriter  SettingSuggestionsLogWriter</p>
<p><a href="http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/core/instrumentation/EventLogWriter.java" target="_blank" rel="noopener">http://androidxref.com/8.0.0_r4/xref/packages/apps/Settings/src/com/android/settings/core/instrumentation/EventLogWriter.java</a></p>
<p>EventLogWriter 中 MetricsLogger  </p>
<p>以上分析 只能指定 android 系统API 更改了 不能找到相应的 解决方法</p>
<h2 id="换条路吧"><a href="#换条路吧" class="headerlink" title="换条路吧"></a>换条路吧</h2><p>从代码上看 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wifiManager.addNetwork返回-1</span><br></pre></td></tr></table></figure>
<p>应该是失败原因 </p>
<p>纠结好几个小时 发现<br>在设置中忘记配置 连接是成功的</p>
<h4 id="原因分析-1"><a href="#原因分析-1" class="headerlink" title="原因分析"></a>原因分析</h4><p>android M 连接无 Internet 会提示 是否自动切换<br>一旦自动切换 那就记录下来了 </p>
<p>下次 自动连接 就连接不了 检测网络又问题 就自动切换了 </p>
<h4 id="解决版本"><a href="#解决版本" class="headerlink" title="解决版本"></a>解决版本</h4><h5 id="自动连接前-删除配置信息"><a href="#自动连接前-删除配置信息" class="headerlink" title="自动连接前 删除配置信息"></a>自动连接前 删除配置信息</h5><p>应该在自动连接前 添加 忘记配置就可以了</p>
<ol>
<li>系统 忘记配置 系统的方法</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Delete the network in the supplicant config.</span><br><span class="line"> *</span><br><span class="line"> * This function is used instead of a sequence of removeNetwork()</span><br><span class="line"> * and saveConfiguration().</span><br><span class="line"> *</span><br><span class="line"> * @param config the set of variables that describe the configuration,</span><br><span class="line"> *            contained in a &#123;@link WifiConfiguration&#125; object.</span><br><span class="line"> * @param listener for callbacks on success or failure. Can be null.</span><br><span class="line"> * @throws IllegalStateException if the WifiManager instance needs to be</span><br><span class="line"> * initialized again</span><br><span class="line"> * @hide</span><br><span class="line"> */</span><br><span class="line">public void forget(int netId, ActionListener listener) &#123;</span><br><span class="line">    if (netId &lt; 0) throw new IllegalArgumentException(&quot;Network id cannot be negative&quot;);</span><br><span class="line">    validateChannel();</span><br><span class="line">    sAsyncChannel.sendMessage(FORGET_NETWORK, netId, putListener(listener));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>hide 不能使用啊</p>
<p>反射吧 android  9.0 禁止了  放弃反射</p>
<p>好吧 放弃 </p>
<p>removeNetwork()  试试 发现 不行啊 </p>
<ol start="2">
<li>让系统 不检测 是否有可以用的 Internet</li>
</ol>
<p><a href="https://blog.csdn.net/u010042260/article/details/52931489" target="_blank" rel="noopener">https://blog.csdn.net/u010042260/article/details/52931489</a></p>
<p>frameworks/base/services/core/java/com/android/server/connectivity/NetworkMonitor.java<br>修改：mIsCaptivePortalCheckEnabled = false；即可。</p>
<p>isCaptivePortal() 这个方法真的 在检测了  </p>
<p>修改 mIsCaptivePortalCheckEnabled 没有方法 不能反射</p>
<p>通过命令 修改  不需要 root </p>
<p><a href="https://android.stackexchange.com/questions/100657/how-to-disable-captive-portal-detection-how-to-remove-exclamation-mark-on-wi-fi" target="_blank" rel="noopener">https://android.stackexchange.com/questions/100657/how-to-disable-captive-portal-detection-how-to-remove-exclamation-mark-on-wi-fi</a></p>
<p><a href="https://support.honeywellaidc.com/s/article/What-does-limited-or-no-Internet-Access-mean" target="_blank" rel="noopener">https://support.honeywellaidc.com/s/article/What-does-limited-or-no-Internet-Access-mean</a></p>
<p>修改了 但是 连接 无可用的 Internet<br>还是提示了</p>
<p>但是 可以连接上了</p>
<p><a href="https://android.stackexchange.com/questions/100657/how-to-disable-captive-portal-detection-how-to-remove-exclamation-mark-on-wi-fi" target="_blank" rel="noopener">https://android.stackexchange.com/questions/100657/how-to-disable-captive-portal-detection-how-to-remove-exclamation-mark-on-wi-fi</a></p>
<p>settings put global captive_portal_detection_enabled 1<br>刚刚开始 没用<br>重启后 可以连接上了 </p>
<p>不太确定 是不是 这个原因<br>还是重启 系统导致的</p>
<p>恢复之前的值<br><code>settings put global captive_portal_detection_enabled null</code><br>之后  现在无法复现了<br>问题 待更近  </p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href target="_blank">Snippet</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018/01/25/前端/css/css常用属性/" class="pre-post btn btn-default" title="CSS 常用属性">
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">CSS 常用属性</span>
        </a>
    
    
        <a href="/2018/01/25/android/Umeng_Push/" class="next-post btn btn-default" title="android umeng push 集成">
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">android umeng push 集成</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: 'xOKV9J4UeQAtVkvnJC7Kq2Jn-gzGzoHsz',
            appKey: 'erIpQac4azoCmgfBB7Dl9maa',
            placeholder: '说点什么吧',
            notify: false,
            verify: false,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#android-wifi-自动连接"><span class="toc-text">android wifi 自动连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#无密码连接"><span class="toc-text">无密码连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有密码连接"><span class="toc-text">有密码连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#兼容性问题"><span class="toc-text">兼容性问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原因分析"><span class="toc-text">原因分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#android-4-4-4"><span class="toc-text">android 4.4.4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-1"><span class="toc-text">7.1.1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-0-0-8-0-0-r4"><span class="toc-text">8.0.0  8.0.0_r4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#换条路吧"><span class="toc-text">换条路吧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#原因分析-1"><span class="toc-text">原因分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解决版本"><span class="toc-text">解决版本</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#自动连接前-删除配置信息"><span class="toc-text">自动连接前 删除配置信息</span></a></li></ol></li></ol></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2017
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>